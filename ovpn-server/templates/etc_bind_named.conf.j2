// Generated by Ansible at {{ lookup('pipe', 'hostname -f') }}
// Any changes made here will be overwritten

// This is the primary configuration file for the BIND DNS server named.
//
// Please read /usr/share/doc/bind9/README.Debian.gz for information on the 
// structure of BIND configuration files in Debian, *BEFORE* you customize 
// this configuration file.
//
// If you are just adding zones, please do that in /etc/bind/named.conf.local

//include "/etc/bind/named.conf.options";
include "/etc/bind/named.conf.local";
include "/etc/bind/named.conf.default-zones";

// Set up our personal DNS resolver
options {
  directory "/var/cache/bind";
  dnssec-validation auto;
  auth-nxdomain no;

  // Avoid DNS-amplification / open resolver:
  // Only replace the list of IPs with 'any' when firewall rules are in place
  allow-recursion { 127.0.0.1; 10.8.0.0/24; };
  allow-query-cache { 10.8.0.0/24; };
  allow-query { 10.8.0.0/24; };
  allow-transfer { none; };

  listen-on port 53 { localnets; };
//  listen-on-v6 port 53 { localnets; };
};

logging {
  channel default_file {
    file "/var/log/named/default.log" versions 3 size 5m;
    severity dynamic;
    print-time yes;
  };

  channel general_file {
    file "/var/log/named/general.log" versions 3 size 5m;
    severity dynamic;
    print-time yes;
  };

  channel queries_file {
    file "/var/log/named/queries.log" versions 3 size 5m;
    severity dynamic;
    print-time yes;
  };

  category default { default_file; };
  category general { general_file; };
  // Comment out the line below to enable logging all requests
  // category queries { queries_file; };
};